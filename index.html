<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Apocalypse</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas" aria-label="Pixel Apocalypse game canvas - Use WASD or arrow keys to move">
            Your browser does not support HTML5 Canvas. Please use a modern browser to play this game.
        </canvas>
        
        <!-- UI Overlays -->
        <div id="ui-overlay">
            <!-- Top UI -->
            <div id="top-ui">
                <div id="player-stats">
                    <div class="stat-row">
                        <label>HP:</label>
                        <div id="hp-bar-container" class="bar-container">
                            <div id="hp-bar" class="bar"></div>
                            <span id="hp-text" class="bar-text">100/100</span>
                        </div>
                    </div>
                    <div class="stat-row">
                        <label>Lv <span id="level">1</span></label>
                        <div id="xp-bar-container" class="bar-container">
                            <div id="xp-bar" class="bar xp"></div>
                            <span id="xp-text" class="bar-text">0/100</span>
                        </div>
                    </div>
                </div>
                <div id="time-display">
                    <label>Time:</label>
                    <span id="time">0:00</span>
                </div>
            </div>
            
            <!-- Route Progress UI -->
            <div id="route-progress" class="route-progress hidden">
                <h3>🎯 ゴールまで</h3>
                <p class="distance-remaining"><span id="distance-remaining">0</span>m</p>
                <div class="route-progress-bar">
                    <div id="route-progress-fill" class="route-progress-fill"></div>
                </div>
            </div>
        </div>

        <!-- Level Up Screen -->
        <div id="levelup-screen" class="modal hidden">
            <div class="modal-content">
                <h2>LEVEL UP!</h2>
                <p>Choose a power-up:</p>
                <div id="powerup-options"></div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="modal hidden">
            <div class="modal-content">
                <h2>GAME OVER</h2>
                <p id="final-stats"></p>
                <button id="restart-button" class="game-button">RESTART</button>
            </div>
        </div>

        <!-- Route Selection Screen -->
        <div id="route-selection-screen" class="modal">
            <div class="modal-content route-selection-content">
                <h1>PIXEL APOCALYPSE</h1>
                <h2>ルートを選択</h2>
                <p class="game-description">
                    実在の街を舞台に、スタート地点からゴールまで生き残れ！
                </p>
                <div id="route-list" class="route-grid">
                    <!-- Routes will be inserted here by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Custom Route Modal -->
        <div id="custom-route-modal" class="modal hidden">
            <div class="modal-content custom-route-content">
                <h2>カスタムルート設定</h2>
                
                <div class="input-section">
                    <h3>住所で指定</h3>
                    <div class="input-group">
                        <label>スタート地点</label>
                        <input type="text" id="start-address" placeholder="例: 渋谷駅">
                        <button onclick="geocodeCustomAddress('start')" class="game-button">検索</button>
                    </div>
                    
                    <div class="input-group">
                        <label>ゴール地点</label>
                        <input type="text" id="goal-address" placeholder="例: 新宿駅">
                        <button onclick="geocodeCustomAddress('goal')" class="game-button">検索</button>
                    </div>
                </div>
                
                <div id="custom-route-info" class="custom-route-info hidden">
                    <h3>ルート情報</h3>
                    <p>📍 距離: <span id="custom-distance">-</span> km</p>
                    <p>⏱️ 予想時間: <span id="custom-time">-</span></p>
                    <p>難易度: <span id="custom-difficulty">-</span></p>
                </div>
                
                <div class="button-group">
                    <button onclick="startCustomRoute()" id="start-custom-btn" class="game-button" disabled>スタート</button>
                    <button onclick="closeCustomModal()" class="game-button">キャンセル</button>
                </div>
            </div>
        </div>

        <!-- Weapon Selection Screen -->
        <div id="weapon-selection-screen" class="modal hidden">
            <div class="modal-content">
                <h1>PIXEL APOCALYPSE</h1>
                <p class="game-description">
                    武器を選択してゲームを開始<br>
                    <small>クリックまたはキー 1, 2, 3 で選択</small>
                </p>
                <div id="weapon-options">
                    <!-- Weapon options will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="modal hidden">
            <div class="modal-content">
                <h1>PIXEL APOCALYPSE</h1>
                <p class="game-description">
                    敵の大群から生き延びろ！<br>
                    時間とともに強力になる敵を倒し続けよう。
                </p>
                <div class="controls-info">
                    <h3>操作方法</h3>
                    <p>
                        <strong>移動:</strong> WASD または 矢印キー<br>
                        <strong>攻撃:</strong> 自動攻撃<br>
                        <strong>目標:</strong> できるだけ長く生き延びる
                    </p>
                </div>
                <button id="start-button" class="game-button">START GAME</button>
            </div>
        </div>
    </div>

    <!-- Load all JavaScript modules -->
    <script src="config.js"></script>
    <script src="data/road-data.js"></script>
    <script src="route-manager.js"></script>
    <script src="road-system.js"></script>
    <script src="map-renderer.js"></script>
    <script src="death-screen.js"></script>
    <script src="game.js"></script>
</body>
</html>
